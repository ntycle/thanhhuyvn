<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Tra c·ª©u ƒë∆°n h√†ng Shopee</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 1000px;
      margin: auto;
    }
    input {
      padding: 8px;
      width: 300px;
    }
    button {
      padding: 8px 12px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      font-size: 14px;
    }
    th {
      background-color: #f5f5f5;
    }
    tfoot td {
      font-weight: bold;
      background-color: #fafafa;
    }
  </style>
</head>
<body>

  <h2>üîé Tra c·ª©u ƒë∆°n h√†ng Shopee</h2>
  <p>Nh·∫≠p ID ƒë∆°n h√†ng (c√≥ th·ªÉ nh·∫≠p nhi·ªÅu, c√°ch nhau b·∫±ng d·∫•u ph·∫©y):</p>
  <input type="text" id="searchBox" placeholder="VD: 250730GYY7TUQS, 250731ABC123">
  <button onclick="search()">T√¨m ki·∫øm</button>

  <table id="resultTable">
    <thead><tr id="thead"></tr></thead>
    <tbody id="tbody"></tbody>
    <tfoot><tr id="tfoot"></tr></tfoot>
  </table>

  <script>
    let data = [];

    fetch("data.json")
      .then(res => res.json())
      .then(json => data = json)
      .catch(err => alert("Kh√¥ng t·∫£i ƒë∆∞·ª£c file data.json"));

    function search() {
      const input = document.getElementById("searchBox").value.trim();
      const ids = input.split(",").map(x => x.trim());
      const results = data.filter(row => ids.includes(row["ID ƒë∆°n h√†ng"]));

      const table = document.getElementById("resultTable");
      const thead = document.getElementById("thead");
      const tbody = document.getElementById("tbody");
      const tfoot = document.getElementById("tfoot");

      thead.innerHTML = "";
      tbody.innerHTML = "";
      tfoot.innerHTML = "";

      if (results.length === 0) {
        tbody.innerHTML = "<tr><td colspan='99'>Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng n√†o.</td></tr>";
        return;
      }

      // ·∫®n c·ªôt "Hoa h·ªìng Shopee tr√™n s·∫£n ph·∫©m(‚Ç´)"
      const allCols = Object.keys(results[0]);
      const visibleCols = allCols.filter(col => col !== "Hoa h·ªìng Shopee tr√™n s·∫£n ph·∫©m(‚Ç´)");

      // T√≠nh t·ªïng
      let totalValue = 0;
      let totalDiscount = 0;

      // Header
      for (const col of visibleCols) {
        const th = document.createElement("th");
        th.textContent = col;
        thead.appendChild(th);
      }

      // Rows
      results.forEach(row => {
        // N·∫øu hoa h·ªìng = 0 th√¨ chi·∫øt kh·∫•u 2% c≈©ng = 0
        if (parseFloat(row["Hoa h·ªìng Shopee tr√™n s·∫£n ph·∫©m(‚Ç´)"]) === 0) {
          row["Chi·∫øt Kh·∫•u 2%"] = "0";
        }

        const tr = document.createElement("tr");
        visibleCols.forEach(col => {
          const td = document.createElement("td");
          td.textContent = row[col];
          tr.appendChild(td);
        });
        tbody.appendChild(tr);

        totalValue += parseFloat(row["Gi√° tr·ªã ƒë∆°n h√†ng (‚Ç´)"]) || 0;
        totalDiscount += parseFloat(row["Chi·∫øt Kh·∫•u 2%"]) || 0;
      });

      // Footer
      visibleCols.forEach(col => {
        const td = document.createElement("td");
        if (col === "Gi√° tr·ªã ƒë∆°n h√†ng (‚Ç´)") {
          td.textContent = totalValue.toLocaleString();
        } else if (col === "Chi·∫øt Kh·∫•u 2%") {
          td.textContent = totalDiscount.toLocaleString();
        } else {
          td.textContent = "";
        }
        tfoot.appendChild(td);
      });
    }
  </script>

</body>
</html>
